<ion-header [translucent]="true">
  <ion-toolbar>
    <app-toolbar-global [titulo]="'Solicitação e Agendamento'"></app-toolbar-global>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="container bgd">

    <form (ngSubmit)="fazerSolicitacao(form)" #form="ngForm" class="solicitacao-form">

      <!-- Seleção de Endereço -->
        <label for="endereco">
        <h6>Selecione o endereço</h6>
        <ion-select 
          [(ngModel)]="enderecoSelecionado" 
          name="endereco" 
          placeholder="Selecionar" 
          required 
          interface="popover" 
          class="custom-ion-select"
          [compareWith]="compareWithIndex"
        >
          <ion-select-option *ngFor="let endereco of listaEnderecos; let i = index" [value]="i">
            {{ endereco.logradouro }}, {{ endereco.numero || 'S/N' }} - {{ endereco.bairro }}
          </ion-select-option>
        </ion-select>
        </label>

      <button type="button" (click)="abrirModalEndereco()">
        Adicionar Novo Endereço
      </button>

      <!-- Descrição -->
      <label for="desc">
        <h6>Descrição do lixo a ser coletado</h6>
        <textarea 
        id="iddesc"
        name="desc" 
        [(ngModel)]="descricao" 
        placeholder="Digite aqui..." 
        required 
        rows="4">
      </textarea>
      </label>

      <!-- Valor sugerido -->
     <label for="vl">
        <h6 position="stacked">Valor sugerido</h6>
        <ion-input type="number" [(ngModel)]="valorSugerido" name="vl" required></ion-input>
      </label>

      <!-- Imagem (opcional) -->
      
        <ion-label position="stacked">Imagem (opcional)</ion-label>
        <input type="file" name="imagem" (change)="onImagemSelecionada($event)" />
      

      <!-- Agendamento -->
      <div class="agendamento-wrapper">
        <ion-card class="card-data">
          <ion-card-header>
            <ion-card-title>Data do Serviço</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <ion-input type="date" [(ngModel)]="dataSelecionada" name="data" required></ion-input>
          </ion-card-content>
        </ion-card>

        <ion-card class="card-horario">
          <ion-card-header>
            <ion-card-title>Horário do Serviço</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <ion-input type="time" [(ngModel)]="horaSelecionada" name="hora" required class="hora-input"></ion-input>
          </ion-card-content>
        </ion-card>
      </div>

      <!-- Botão de envio -->
      <ion-button class="btn-submit-solicitacao" type="submit" [disabled]="form.invalid || isSubmitting">
        Fazer solicitação
      </ion-button>

      <ion-spinner *ngIf="isSubmitting" name="crescent"></ion-spinner>

    </form>
  </div>
</ion-content>

<app-footer-global></app-footer-global>
